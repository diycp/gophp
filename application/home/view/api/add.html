
{{include_file name='public/header' title='项目管理'}}
<style>
    body {
        background-color: #ffffff;
    }
    .container {
        min-height: 300px;
    }

</style>
</head>

<body>

<div class="container">
    <!-- /.row -->
    <div class="row">
        <form id="js_addApiForm" role="form" action="{{url('api/add')}}" method="post">
            <input type="hidden" class="form-control" name="api_id" value="{{$api.id}}">
            <input type="hidden" class="form-control" name="module_id" value="{{$module.id}}">

            <div class="form-group">
                <label>所属模块</label>
                <input class="form-control" name="api[title]" value="{{$module.title}}" placeholder="必填" disabled>
            </div>

            <div class="form-group">
                <label>接口名称</label>
                <input class="form-control" name="api[title]" value="" placeholder="必填" datatype="*" nullmsg="请输入接口名称">
            </div>

            <div class="control-group" style="margin:0 0 10px 0;">
                <label>接口类型</label>
                <label class="radio-inline ">
                    <input type="radio" name="api[request_type]" value="1">get
                </label>
                <label class="radio-inline">
                    <input type="radio" name="api[request_type]" value="2">post
                </label>
                <label class="radio-inline">
                    <input type="radio" name="api[request_type]" value="3" checked="checked">get/post
                </label>
                <label class="radio-inline">
                    <input type="radio" name="api[request_type]" value="4">put
                </label>
            </div>

            <div class="form-group">
                <label>请求路径</label>
                <input type="text" name="api[request_url]" class="form-control" placeholder="必填，http://" datatype="url" nullmsg="请输入请求地址">
            </div>

            <div class="form-group">
                <label>接口描述</label>
                <textarea class="form-control" name="api[intro]" rows="2" placeholder="非必填"></textarea>
                <span class="Validform_checktip"></span>
            </div>

            <input type="hidden" id="js_submit" value="提交">

        </form>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
</div>
<!-- /#wrapper -->

<script>

    $(function(){

        //验证表单
        $("#js_addApiForm").validateForm({
            submitBtn: '#js_submit',
            before:function () {
                // iframe父级提交按钮禁用
                $('#js_addApiForm', parent.document).find(".js_submit").attr("disabled", "disabled").text('提交中..');
            },
            success:function () {

                parent.$('#js_addApiModal').modal('hide');

            },
            error:function () {
                // iframe父级提交按钮激活
                $('#js_addApiForm', parent.document).find(".js_submit").text('重新提交').removeAttr("disabled");

            }
        });

        $('.js_addUrlBtn').on('click', function () {
            var inputObj = $(this).siblings('input');
            var url = inputObj.val();
            if(!url){
                inputObj.focus();
                alert('请输入合法的URL');
            }else{
                $(".input-group").after($(".input-group").clone());
            }

        });

    });


</script>

{{include_file name='public/footer'}}
